CREATE SCHEMA IF NOT EXISTS midterm;

DROP SCHEMA midterm;

USE midterm;

CREATE TABLE user_table (
    id BIGINT AUTO_INCREMENT NOT NULL,
    username VARCHAR(255),
    password VARCHAR(255),
    PRIMARY KEY (id)
);
CREATE TABLE role_table (
    id BIGINT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    name VARCHAR(255),
    user_id BIGINT,
    FOREIGN KEY (user_id) REFERENCES user_table (id)
);

CREATE TABLE IF NOT EXISTS admin_table (
id BIGINT,
name VARCHAR (255),
PRIMARY KEY (id),
FOREIGN KEY (user_id) REFERENCES user_table (id)
);

CREATE TABLE IF NOT EXISTS third_party (
id BIGINT,
name VARCHAR (255),
hashedKey VARCHAR (255),
PRIMARY KEY (id),
FOREIGN KEY (user_id) REFERENCES user_table (id)
);

CREATE TABLE IF NOT EXISTS account_holder (
id BIGINT,
first_name VARCHAR (255),
date_of_birth DATE,
mailing_address VARCHAR (255),
PRIMARY KEY (id),
FOREIGN KEY (user_id) REFERENCES user_table (id)
);

CREATE TABLE IF NOT EXISTS address (
id INT NOT NULL AUTO_INCREMENT,
street VARCHAR (255),
building_number SMALLINT,
floor TINYINT,
door CHAR,
zip_code INT,
city VARCHAR (255),
country VARCHAR (255),
inhabitant BIGINT,
PRIMARY KEY(id),
FOREIGN KEY (inhabitant) REFERENCES account_holder (id) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE IF NOT EXISTS account_table (
id BIGINT NOT NULL UNIQUE,
balance DECIMAL,
secret_key VARCHAR(255),
primary_owner BIGINT,
secondary_owner BIGINT,
penaltyFee DECIMAL,
status VARCHAR(255),
creationDate DATE DEFAULT (current_date()),
PRIMARY KEY (id),
FOREIGN KEY (primary_owner) REFERENCES account_holder (id) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (secondary_owner) REFERENCES account_holder (id) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS checking (
id BIGINT,
minimum_balance DECIMAL,
monthly_maintenance_fee DECIMAL,
PRIMARY KEY (id),
FOREIGN KEY (id) REFERENCES account_table (id) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS credit_card (
id BIGINT,
credit_limit DECIMAL,
interest_rate DECIMAL,
PRIMARY KEY (id),
FOREIGN KEY (id) REFERENCES account_table (id) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS savings (
id BIGINT,
minimum_balance DECIMAL,
interest_rate DECIMAL,
PRIMARY KEY (id),
FOREIGN KEY (id) REFERENCES account_table (id) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE IF NOT EXISTS student_checking (
id BIGINT,
PRIMARY KEY (id),
FOREIGN KEY (id) REFERENCES account_table (id) ON UPDATE CASCADE ON DELETE CASCADE
);
